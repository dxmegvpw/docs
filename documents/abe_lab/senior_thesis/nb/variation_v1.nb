(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54341,       1506]
NotebookOptionsPosition[     53742,       1487]
NotebookOutlinePosition[     54159,       1504]
CellTagsIndexPosition[     54116,       1501]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Pinverse", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pinverse", "=", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["7", 
        SqrtBox["51"]], ",", 
       RowBox[{"-", 
        SqrtBox[
         FractionBox["2", "51"]]}], ",", 
       RowBox[{"-", 
        SqrtBox[
         FractionBox["2", "51"]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["51"]], ",", 
       FractionBox["7", 
        SqrtBox["102"]], ",", 
       FractionBox["7", 
        SqrtBox["102"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["51"]], ",", 
       FractionBox["7", 
        SqrtBox["102"]], ",", 
       FractionBox["7", 
        SqrtBox["102"]]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Pinverse", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.912911143226863*^9, 3.912911148907627*^9}, {
   3.9129115707647486`*^9, 3.912911579462083*^9}, {3.913574328657543*^9, 
   3.9135743353234444`*^9}, {3.91357442940843*^9, 3.9135744313095093`*^9}, {
   3.913754482322376*^9, 3.9137544930263*^9}, {3.9137551584032636`*^9, 
   3.9137551724877577`*^9}, 3.913934732257524*^9, 3.914408593669671*^9, {
   3.9144086889697294`*^9, 3.91440871239355*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"9332ed29-c3f5-4612-b447-02dcfafb07ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["7", 
       SqrtBox["51"]], 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "51"]]}], 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "51"]]}]},
     {
      FractionBox["1", 
       SqrtBox["51"]], 
      FractionBox["7", 
       SqrtBox["102"]], 
      FractionBox["7", 
       SqrtBox["102"]]},
     {
      FractionBox["1", 
       SqrtBox["51"]], 
      FractionBox["7", 
       SqrtBox["102"]], 
      FractionBox["7", 
       SqrtBox["102"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9129112686791134`*^9, 3.912911440106556*^9, {3.9129115773488936`*^9, 
   3.9129115823933473`*^9}, 3.9134113861916323`*^9, 3.9134116391768084`*^9, 
   3.9134136570088606`*^9, 3.913413823823395*^9, 3.9135744316927013`*^9, {
   3.9137544771035023`*^9, 3.913754494183084*^9}, 3.91375517521865*^9, 
   3.9139347343854384`*^9, 3.9141551475225725`*^9, 3.914408596549139*^9, {
   3.9144086892751226`*^9, 3.914408712750757*^9}},
 CellLabel->
  "Out[16]//MatrixForm=",ExpressionUUID->"c458bc7f-2fe7-4624-ad32-\
996bac1fe1f5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "w", ",", "k", ",", "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r",
     ",", "B", ",", "b", ",", "c", ",", "d", ",", "\[Delta]t", ",", 
    "\[Delta]x", ",", "V", ",", "zero", ",", "vevt2", ",", "vevt3"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "wt", ",", "wtt", ",", "wttt", ",", "wx", ",", "wxx", ",", "wtx", ",", 
    "kt", ",", "ktt", ",", "kx", ",", "kxx", ",", "ktx"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "DtW", ",", "DtWt", ",", "DtWx", ",", "DtWtt", ",", "DtWxx", ",", 
    "DtWtx"}], "]"}], ";", 
  RowBox[{"Clear", "[", 
   RowBox[{
   "Wtrue", ",", "DtWtrue", ",", "kxtrue", ",", "wxtrue", ",", "wttrue", ",", 
    "kttrue", ",", "DxWtrue", ",", "DtWtrue", ",", "ktrue", ",", "expKtrue", 
    ",", "ktttrue", ",", "kxxtrue"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "V0", ",", "dV0", ",", "VT", ",", "VX", ",", "VTX", ",", "VTT", ",", "VXX",
     ",", "vart", ",", "varx", ",", "vevt2", ",", "vevt3"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"xref", ",", "tref", ",", "sol"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zero", "[", "x_", "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{"w0", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "r", "]"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"a", "[", "r", "]"}]}], " ", "t"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
        RowBox[{"B", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "b"}], " ", "t"}], "]"}], "x"}]}]}], ";", 
      RowBox[{
       RowBox[{"k", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], 
         RowBox[{"Log", "[", 
          RowBox[{"t", "+", 
           RowBox[{"Conjugate", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"x", "*", 
         RowBox[{"Conjugate", "[", "x", "]"}]}]}]}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"wt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wtt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wttt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "3"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wxx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wtx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"kt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"ktt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", 
          RowBox[{"Conjugate", "[", "t", "]"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"kx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"kxx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "x", ",", 
          RowBox[{"Conjugate", "[", "x", "]"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"ktx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"k", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", "\n", "\n", 
      RowBox[{
       RowBox[{"DtW", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"wt", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "+", 
        RowBox[{
         RowBox[{"kt", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "*", 
         RowBox[{"w", "[", 
          RowBox[{"t", ",", "x"}], "]"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"DtWt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"DtW", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DtWx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"DtW", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DtWtt", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"DtW", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DtWxx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"DtW", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DtWtx", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"DtW", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DxW", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"wx", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"kx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "*", 
          RowBox[{"w", "[", 
           RowBox[{"t", ",", "x"}], "]"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Wtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"wt", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]t"}], "+", 
         RowBox[{
          RowBox[{"wx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]x"}], "+", 
         RowBox[{
          RowBox[{"wtt", "[", 
           RowBox[{"t", ",", "x"}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"wxx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"wtx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]t", " ", 
          RowBox[{"\[Delta]x", "/", "2"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DtWtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DtW", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"DtWt", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]t"}], "+", 
         RowBox[{
          RowBox[{"DtWx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]x"}], "+", 
         RowBox[{
          RowBox[{"DtWtt", "[", 
           RowBox[{"t", ",", "x"}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"DtWxx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"DtWtx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]t", " ", 
          RowBox[{"\[Delta]x", "/", "2"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"kxtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"kx", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", 
          RowBox[{"\[Delta]x", "/", "2"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wxtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"wx", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", 
          RowBox[{"\[Delta]x", "/", "2"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"wttrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"wt", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"wt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", 
          RowBox[{"\[Delta]x", "/", "2"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"kttrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"kt", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", 
          RowBox[{"\[Delta]x", "/", "2"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DxWtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DxW", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DxW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DxW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DxW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DxW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DxW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", "\[Delta]x"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"DtWtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DtW", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DtW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DtW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DtW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DtW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"DtW", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", "\[Delta]x"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"ktrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"kt", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]t"}], "+", 
         RowBox[{
          RowBox[{"kx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]x"}], "+", 
         RowBox[{
          RowBox[{"ktt", "[", 
           RowBox[{"t", ",", "x"}], "]"}], 
          RowBox[{"\[Delta]t", "^", "2"}]}], "+", 
         RowBox[{
          RowBox[{"kxx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], 
          RowBox[{"\[Delta]x", "^", "2"}]}], "+", 
         RowBox[{
          RowBox[{"ktx", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "\[Delta]t", " ", "\[Delta]x"}]}], 
        "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{"expKtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{"1", "+", 
         RowBox[{"ktrue", "[", 
          RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], "]"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ktrue", "[", 
             RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
             "]"}], "^", "2"}], ")"}], "/", "2"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ktttrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ktt", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ktt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ktt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ktt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ktt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"ktt", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", "\[Delta]x"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kxxtrue", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"kxx", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kxx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Delta]t"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kxx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "\[Delta]x"}],
          "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kxx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]t", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kxx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Delta]x", "^", "2"}], "/", "2"}]}], "+", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"kxx", "[", 
             RowBox[{"t", ",", "x"}], "]"}], ",", "t", ",", "x"}], "]"}], 
          "\[Delta]t", " ", "\[Delta]x"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V0", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", "\n", 
       RowBox[{"Refine", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"k", "[", 
             RowBox[{"t", ",", "x"}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"ktt", "[", 
                 RowBox[{"t", ",", "x"}], "]"}]}], ")"}], "*", 
              RowBox[{"DtW", "[", 
               RowBox[{"t", ",", "x"}], "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"DtW", "[", 
                RowBox[{"t", ",", "x"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"kxx", "[", 
                 RowBox[{"t", ",", "x"}], "]"}]}], ")"}], "*", 
              RowBox[{"DxW", "[", 
               RowBox[{"t", ",", "x"}], "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"DxW", "[", 
                RowBox[{"t", ",", "x"}], "]"}], "]"}]}], "\n", "-", 
             RowBox[{"3", 
              RowBox[{"w", "[", 
               RowBox[{"t", ",", "x"}], "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"w", "[", 
                RowBox[{"t", ",", "x"}], "]"}], "]"}]}]}], ")"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r", ",", "B", 
             ",", "b", ",", "c", ",", "d"}], "}"}], ",", "Reals"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dV0", "[", 
        RowBox[{"t_", ",", "x_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"V0", "[", 
           RowBox[{"t", ",", "x"}], "]"}], ",", "x"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "[", 
        RowBox[{"t_", ",", "x_", ",", "\[Delta]t_", ",", "\[Delta]x_"}], 
        "]"}], "=", "\n", 
       RowBox[{"Refine", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"expKtrue", "[", 
            RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
            "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"ktttrue", "[", 
                 RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"DtWtrue", "[", 
               RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
               "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"DtWtrue", "[", 
                RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
                "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"kxxtrue", "[", 
                 RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"DxWtrue", "[", 
               RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
               "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"DxWtrue", "[", 
                RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
                "]"}], "]"}]}], "\n", "-", 
             RowBox[{"3", 
              RowBox[{"Wtrue", "[", 
               RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
               "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"Wtrue", "[", 
                RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
                "]"}], "]"}]}]}], ")"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "''"}], "\[Rule]", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "r", ",", "B", ",", "b", ",", "c", 
             ",", "d"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"VT", "=", 
       RowBox[{"Refine", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
             "]"}], ",", "\[Delta]t"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Delta]t", "->", "0"}], ",", 
            RowBox[{"\[Delta]x", "->", "0"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r", ",", "B", 
             ",", "b", ",", "c", ",", "d", ",", "\[Delta]t", ",", 
             "\[Delta]x"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VX", "=", 
       RowBox[{"Refine", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
             "]"}], ",", "\[Delta]t"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Delta]t", "->", "0"}], ",", 
            RowBox[{"\[Delta]x", "->", "0"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r", ",", "B", 
             ",", "b", ",", "c", ",", "d", ",", "\[Delta]t", ",", 
             "\[Delta]x"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VTT", "=", 
       RowBox[{"Refine", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Delta]t", ",", "2"}], "}"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Delta]t", "->", "0"}], ",", 
            RowBox[{"\[Delta]x", "->", "0"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "''"}], "->", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r", ",", "B", 
             ",", "b", ",", "c", ",", "d", ",", "\[Delta]t", ",", 
             "\[Delta]x"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VXX", "=", 
       RowBox[{"Refine", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Delta]x", ",", "2"}], "}"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Delta]t", "->", "0"}], ",", 
            RowBox[{"\[Delta]x", "->", "0"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "''"}], "->", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r", ",", "B", 
             ",", "b", ",", "c", ",", "d", ",", "\[Delta]t", ",", 
             "\[Delta]x"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VTX", "=", 
       RowBox[{"Refine", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"t", ",", "x", ",", "\[Delta]t", ",", "\[Delta]x"}], 
             "]"}], ",", "\[Delta]t", ",", "\[Delta]x"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Delta]t", "->", "0"}], ",", 
            RowBox[{"\[Delta]x", "->", "0"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "'"}], "->", "zero"}], ",", 
            RowBox[{
             RowBox[{"Conjugate", "''"}], "->", "zero"}]}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "w0", ",", "A", ",", "a", ",", "t", ",", "x", ",", "r", ",", "B", 
             ",", "b", ",", "c", ",", "d", ",", "\[Delta]t", ",", 
             "\[Delta]x"}], "}"}], ",", "Reals"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "parameter", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vevt2", "=", "0"}], ";", 
      RowBox[{"vevt3", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "=", 
       RowBox[{"2", " ", "Pi", "*", 
        RowBox[{"Pinverse", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], "=", 
       RowBox[{"2", " ", "Pi", "*", 
        RowBox[{"Pinverse", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], "=", 
       RowBox[{"2", " ", "Pi", "*", 
        RowBox[{"Pinverse", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"a", "[", "1", "]"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Pinverse", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "vevt2"}], "+", 
             RowBox[{
              RowBox[{"Pinverse", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", "vevt3"}]}], 
            ")"}]}], ")"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"A", "[", "2", "]"}], "=", "0"}], ";", 
      RowBox[{
       RowBox[{"A", "[", "3", "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "1", "]"}], "=", "1"}], ";", 
      RowBox[{
       RowBox[{"c", "[", "2", "]"}], "=", "1"}], ";", 
      RowBox[{
       RowBox[{"c", "[", "3", "]"}], "=", "1"}], ";", 
      RowBox[{
       RowBox[{"d", "[", "1", "]"}], "=", "0"}], ";", 
      RowBox[{
       RowBox[{"d", "[", "2", "]"}], "=", "0"}], ";", 
      RowBox[{
       RowBox[{"d", "[", "3", "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"w0", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "30"}], ")"}]}]}], ";", 
      RowBox[{"B", "=", "1"}], ";", 
      RowBox[{"b", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"T", ",", "X"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<W(T,X)=\>\"", ",", 
        RowBox[{"w", "[", 
         RowBox[{"T", ",", "X"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<K(T,X)=\>\"", ",", 
        RowBox[{"k", "[", 
         RowBox[{"T", ",", "X"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"determine", " ", "t"}], ",", 
        RowBox[{"x", " ", "by", " ", "reference", " ", "point"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tref", ",", "xref"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"dV0", "[", 
            RowBox[{"tref", ",", "xref"}], "]"}], "]"}], "]"}], ">", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "10"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sol", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DtW", "[", 
              RowBox[{"t", ",", "x"}], "]"}], "==", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "x"}], "}"}], ",", "Reals", ",", 
            RowBox[{"RandomSeeding", "\[Rule]", "Automatic"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tref", ",", "xref"}], "}"}], "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "x"}], "}"}], "/.", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VT", "*", "VXX"}], "-", 
           RowBox[{"VX", "*", "VTX"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VTX", "^", "2"}], "-", 
           RowBox[{"VTT", "*", "VXX"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "->", "tref"}], ",", 
          RowBox[{"x", "->", "xref"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VT", "*", "VTX"}], "-", 
           RowBox[{"VX", "*", "VTT"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VTT", "*", "VXX"}], "-", 
           RowBox[{"VTX", "^", "2"}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "->", "tref"}], ",", 
          RowBox[{"x", "->", "xref"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", " ", "the", " ", "Output"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<(tref,xref)=(\>\"", ",", "tref", ",", "\"\<,\>\"", ",", "xref", 
        ",", "\"\<)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<DtW=\>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"DtW", "[", 
          RowBox[{"tref", ",", "xref"}], "]"}], "]"}], ",", "\"\<, dV0=\>\"", 
        ",", 
        RowBox[{"N", "[", 
         RowBox[{"dV0", "[", 
          RowBox[{"tref", ",", "xref"}], "]"}], "]"}]}], "]"}], ";"}], ".", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<V_X=\>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{"dV0", "[", 
         RowBox[{"tref", ",", "xref"}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\[Delta]t/t=\>\"", ",", 
      RowBox[{"N", "[", 
       RowBox[{"vart", "/", "tref"}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\[Delta]x/x=\>\"", ",", 
      RowBox[{"N", "[", 
       RowBox[{"varx", "/", "xref"}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.912908000685108*^9, 3.9129081301508694`*^9, 3.912908245471551*^9, {
   3.912908276984161*^9, 3.912908312726328*^9}, {3.912908347572852*^9, 
   3.912908426160144*^9}, {3.9129088016805696`*^9, 3.912909402005165*^9}, {
   3.912909450078139*^9, 3.912909572772689*^9}, {3.9129097734785166`*^9, 
   3.9129098933370924`*^9}, {3.9129100053000827`*^9, 
   3.9129100134628305`*^9}, {3.912910188222825*^9, 3.9129102467928762`*^9}, {
   3.9129102837448235`*^9, 3.9129103097342105`*^9}, {3.9129105613831425`*^9, 
   3.9129105655186677`*^9}, {3.912910611359047*^9, 3.912910619216576*^9}, 
   3.912910832496292*^9, {3.912911451790492*^9, 3.91291146905628*^9}, {
   3.9129115019564114`*^9, 3.912911534493556*^9}, {3.9129116063763027`*^9, 
   3.912911682020099*^9}, {3.9129117518541036`*^9, 3.912911865359825*^9}, {
   3.912911998463306*^9, 3.9129120164005566`*^9}, {3.9129120662452927`*^9, 
   3.9129121005366116`*^9}, {3.912912144454383*^9, 3.9129123088246417`*^9}, {
   3.9129123521081676`*^9, 3.912912385945219*^9}, {3.912912494498006*^9, 
   3.912912538413725*^9}, {3.912912592813363*^9, 3.912912623833289*^9}, {
   3.9129126614186583`*^9, 3.9129130853722553`*^9}, {3.9129131344105124`*^9, 
   3.912913317899864*^9}, {3.912913349326069*^9, 3.912913456583494*^9}, {
   3.9129134894842434`*^9, 3.9129135138961687`*^9}, {3.912913547669034*^9, 
   3.912913634935238*^9}, {3.9134117062372513`*^9, 3.913411729252426*^9}, {
   3.913411775676716*^9, 3.913411786548767*^9}, {3.9134118223143573`*^9, 
   3.9134118572650566`*^9}, {3.9134119002931447`*^9, 3.913411937727315*^9}, {
   3.913411981380319*^9, 3.9134119969144983`*^9}, {3.9134120375341887`*^9, 
   3.9134120888604126`*^9}, {3.913412121336559*^9, 3.913412150598521*^9}, 
   3.9134121927588987`*^9, {3.9134122910818577`*^9, 3.913412435938488*^9}, {
   3.9134124665899477`*^9, 3.9134125805195*^9}, {3.9134126239362936`*^9, 
   3.913412673923339*^9}, 3.913412917711936*^9, {3.913412955321107*^9, 
   3.9134129740157275`*^9}, 3.913413012788947*^9, {3.913414527247014*^9, 
   3.913414533765461*^9}, {3.913414581132539*^9, 3.913414724695571*^9}, {
   3.913414775206041*^9, 3.9134148983268204`*^9}, {3.913414952473322*^9, 
   3.913415003631522*^9}, {3.9134150800616493`*^9, 3.9134150807356634`*^9}, {
   3.9134151741008806`*^9, 3.9134153308105183`*^9}, {3.9134153662597733`*^9, 
   3.913415374354035*^9}, {3.9135744561795473`*^9, 3.913574497728995*^9}, {
   3.913754528092803*^9, 3.913754531634883*^9}, {3.913754588428713*^9, 
   3.9137545970966654`*^9}, {3.913754664649431*^9, 3.913754672533577*^9}, {
   3.9137547072714005`*^9, 3.913754786753905*^9}, {3.913754828466487*^9, 
   3.913754844325652*^9}, {3.913754926371857*^9, 3.913754927885398*^9}, {
   3.913754986435259*^9, 3.91375504459903*^9}, {3.9137550970415573`*^9, 
   3.913755142950343*^9}, {3.913934856071088*^9, 3.913934857659526*^9}, 
   3.9141551595769873`*^9, {3.91415519820455*^9, 3.9141552047052794`*^9}, {
   3.9141552534894505`*^9, 3.914155305238899*^9}, {3.914155350266616*^9, 
   3.914155366929151*^9}, {3.9141568357108774`*^9, 3.9141568410210423`*^9}, {
   3.914196082881935*^9, 3.914196104737957*^9}, {3.9144086373437777`*^9, 
   3.9144086572744846`*^9}, 
   3.9144087785628815`*^9},ExpressionUUID->"3440862e-2b5a-4230-afa0-\
7e888727d5c8"]
},
WindowSize->{1016.25, 620.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2021\:5e7412\:67082\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8282eed4-14fa-40d7-8fd6-6fcd46b4824c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1448, 40, 133, "Input",ExpressionUUID->"9332ed29-c3f5-4612-b447-02dcfafb07ff"],
Cell[2031, 64, 1493, 46, 113, "Output",ExpressionUUID->"c458bc7f-2fe7-4624-ad32-996bac1fe1f5"]
}, Open  ]],
Cell[3539, 113, 50199, 1372, 3515, "Input",ExpressionUUID->"3440862e-2b5a-4230-afa0-7e888727d5c8"]
}
]
*)

